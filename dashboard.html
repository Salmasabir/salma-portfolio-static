const apiUrl = 'http://localhost:5000/api/projects';

const form = document.getElementById('addForm');
const projectsList = document.getElementById('projects-list');

function fetchProjects() {
  fetch(apiUrl)
    .then(res => res.json())
    .then(data => {
      projectsList.innerHTML = '';
      data.forEach(project => {
        const li = document.createElement('li');
        li.innerHTML = `
          <strong>${project.title}</strong> - ${project.description}
          <button onclick="deleteProject('${project._id}')">Supprimer</button>
        `;
        projectsList.appendChild(li);
      });
    })
    .catch(err => console.error('Erreur fetch projects:', err));
}

function deleteProject(id) {
  fetch(${apiUrl}/${id}, { method: 'DELETE' })
    .then(() => fetchProjects())
    .catch(err => console.error('Erreur delete project:', err));
}

form.addEventListener('submit', e => {
  e.preventDefault();
  const title = document.getElementById('title').value.trim();
  const description = document.getElementById('description').value.trim();

  if (!title || !description) {
    alert('Veuillez remplir tous les champs.');
    return;
  }

  fetch(apiUrl, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ title, description })
  })
    .then(() => {
      form.reset();
      fetchProjects();
    })
    .catch(err => console.error('Erreur add project:', err));
});

// Initial fetch
fetchProjects();